!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@datocms/cma-client-browser")):"function"==typeof define&&define.amd?define(["exports","@datocms/cma-client-browser"],e):e((r||self).utils={},r.cmaClientBrowser)}(this,function(r,e){var n,t=/\\\*/g,i=/ASTERISKPLACEHOLDER/gm,o=/\\_/g,u=/UNDERSCOREPLACEHOLDER/gm,s=/UNDERSCOREBOLDPLACEHOLDER/gm,c=/(__)(.*?)(__)/g,a=/ASTERISKBOLDPLACEHOLDER/gm,f=/(\*\*)(.*?)(\*\*)/g,l=/UNDERSCOREITALICPLACEHOLDER/gm,d=/(_)(.*?)(_)/g,h=/ASTERISKITALICPLACEHOLDER/gm,v=/(\*)(.*?)(\*)/g,p=/^\[([^[]+)\]\(([^)]+)\)/,g=[a.source,s.source,h.source,l.source],m=((n={})[u.source]=2,n[i.source]=2,n),E=function(r){for(var e=Object.keys(m),n=0,t=e.length;n<t;n++)if(r.startsWith(e[n]))return e[n];return null},b=function(r,e){for(var n=0,t=g.length;n<t;n++)if(r.startsWith(g[n]))return e[e.length-1]===g[n]?e.pop():e.push(g[n]),g[n];return null};function y(r,e,n){if(!r.s){if(n instanceof A){if(!n.s)return void(n.o=y.bind(null,r,e));1&e&&(e=n.s),n=n.v}if(n&&n.then)return void n.then(y.bind(null,r,e),y.bind(null,r,2));r.s=e,r.v=n;const t=r.o;t&&t(r)}}var A=/*#__PURE__*/function(){function r(){}return r.prototype.then=function(e,n){var t=new r,i=this.s;if(i){var o=1&i?e:n;if(o){try{y(t,1,o(this.v))}catch(r){y(t,2,r)}return t}return this}return this.o=function(r){try{var i=r.v;1&r.s?y(t,1,e?e(i):i):n?y(t,1,n(i)):y(t,2,i)}catch(r){y(t,2,r)}},t},r}();function C(r){return r instanceof A&&1&r.s}var O="undefined"==typeof window,L=function(r){return new Promise(function(e,n){return setTimeout(e,r)})};r.awaitElement=function(r){try{var e,n=function(n){if(e)return n;throw new Error("Element "+r+" not found")},t=0,i=function(r,e,n){for(var t;;){var i=r();if(C(i)&&(i=i.v),!i)return o;if(i.then){t=0;break}var o=n();if(o&&o.then){if(!C(o)){t=1;break}o=o.s}if(e){var u=e();if(u&&u.then&&!C(u)){t=2;break}}}var s=new A,c=y.bind(null,s,2);return(0===t?i.then(f):1===t?o.then(a):u.then(l)).then(void 0,c),s;function a(t){o=t;do{if(e&&(u=e())&&u.then&&!C(u))return void u.then(l).then(void 0,c);if(!(i=r())||C(i)&&!i.v)return void y(s,1,o);if(i.then)return void i.then(f).then(void 0,c);C(o=n())&&(o=o.v)}while(!o||!o.then);o.then(a).then(void 0,c)}function f(r){r?(o=n())&&o.then?o.then(a).then(void 0,c):a(o):y(s,1,o)}function l(){(i=r())?i.then?i.then(f).then(void 0,c):f(i):y(s,1,o)}}(function(){return!e&&t<100},function(){return t++},function(){var n=document.querySelector(function(r){return(r.match(/(#[0-9][^\s:,]*)/g)||[]).forEach(function(e){r=r.replace(e,'[id="'+e.replace("#","")+'"]')}),r}(r));return n?(e=1,n):Promise.resolve(L(30)).then(function(){})});return Promise.resolve(i&&i.then?i.then(n):n(i))}catch(r){return Promise.reject(r)}},r.capitalize=function(r,e){return void 0===e&&(e=!1),(e?r.toLowerCase():r).replace(/(?:^|\s|["'([{])+\S/g,function(r){return r.toUpperCase()})},r.chunkArray=function(r,e){for(var n=[],t=0;t<r.length;t+=e)n.push(r.slice(t,t+e));return n},r.isEmpty=function(r){return 0===Object.keys(r).filter(function(e){return void 0!==r[e]}).length},r.isServer=O,r.iterateObject=function(r,e){var n=0,t=[];if(Array.isArray(r))for(;n<r.length&&!1!==e(r[n],n,r);++n);else if("object"==typeof r&&null!==r)for(t=Object.keys(r);n<t.length&&!1!==e(r[t[n]],t[n],r);++n);},r.markdownTruncate=function(r,e){void 0===r&&(r=""),void 0===e&&(e={limit:1,ellipsis:!1});var n=e||{},g=n.limit,y=n.ellipsis;if(r.length<=g)return r;var A=function(r){return r.replace(o,u.source).replace(t,i.source).replace(c,s.source+"$2"+s.source).replace(f,a.source+"$2"+a.source).replace(d,l.source+"$2"+l.source).replace(v,h.source+"$2"+h.source)}(r);return A=function(r,e,n){var t=0,i=function r(n){for(var i=[],o=!1,u="",s=0;t<e&&s<n.length;){var c=b(n.substring(s),i);c&&(u+=c,s+=c.length,o=!0);var a=E(n.substring(s));a&&(u+=a,s+=a.length,o=!0,t+=m[a]);var f=new RegExp(p).exec(n.substring(s));if(f){var l=f[2];u+="["+r(f[1])+"]("+l+")",s+=f[0].length,o=!0}c||f||(u+=n[s],s++),o||t++,o=!1}for(u=u.trimEnd();i.length>0;)u+=i.pop();return u}(r);return n&&i.length<r.length&&(i+="..."),i}(A,g,y),function(r){return r.replace(u,"\\_").replace(i,"\\*").replace(s,"__").replace(a,"**").replace(l,"_").replace(h,"*")}(A)},r.parseDatoCMSApiError=function(r){return r instanceof e.ApiError==0?"string"==typeof r?r:r.message||r.toString():new e.ApiError(r).errors.map(function(r){var e,n=""+r.attributes.code,t=[];return Array.isArray(null==(e=r.attributes.details)?void 0:e.errors)&&r.attributes.details.errors.forEach(function(r){t.push(Object.keys(r).map(function(e){return e+": "+r[e]}).join(", "))}),n+(t.length?": "+t.join(". "):"")}).join("\n")},r.parseDatoError=function(r){return r.errors.map(function(r){var e=r.attributes,n=e.details;return{code:e.code,field:null==n?void 0:n.field,message:null==n?void 0:n.message,detailsCode:null==n?void 0:n.code,errors:Array.isArray(null==n?void 0:n.errors)?null==n?void 0:n.errors.join(". "):void 0}}).map(function(r){var e=r.field,n=r.errors;return r.code+" "+(e?"("+e+")":"")+" "+(r.message||"")+" "+(r.detailsCode||"")+" "+(n?"("+n+")":"")}).join("\n")},r.rInt=function(r,e){return r=Math.ceil(r),e=Math.floor(e),Math.floor(Math.random()*(e-r+1))+r},r.sleep=L,r.sortSwedish=function(r,e){var n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","Å","Ä","Ö"];return r.sort(function(r,t){var i=n.findIndex(function(n){var t;return n===(null==(t="string"==typeof e?r[e]:r)?void 0:t.charAt(0).toUpperCase())}),o=n.findIndex(function(r){var n;return r===(null==(n="string"==typeof e?t[e]:t)?void 0:n.charAt(0).toUpperCase())});return i?i>o?1:i===o?0:-1:-1})},r.truncateParagraph=function(r,e,n,t){var i,o;if(void 0===e&&(e=1),void 0===n&&(n=!0),void 0===t&&(t=200),!r||r.length<t)return r;var u=null==(i=r.split("."))?void 0:i.slice(0,e+1).join(".").lastIndexOf("."),s=null==(o=r.split("? "))?void 0:o.slice(0,e+1).join("? ").lastIndexOf("? "),c=-1!==s&&s<u||-1===u&&s>-1;return-1===u&&-1===s&&(u=t-1,n=!0),r.substring(0,c?s:u)+(n?"...":c?"?":".")},r.truncateWords=function(r,e){if(r.length<=e)return r;var n=r.substring(0,e),t=n.lastIndexOf(" ");return-1!==t&&(n=n.substr(0,t)),n+"..."}});
//# sourceMappingURL=index.umd.js.map
